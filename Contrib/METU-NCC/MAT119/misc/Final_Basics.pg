## BEGIN_DESCRIPTION
## 
## END_DESCRIPTION
##
##############################################
## DBsubject(Calculus - single variable)
## DBchapter(Techniques of integration)
## DBsection(Substitution (without trigonometric functions))
## Institution(METU-NCC)
## Author(Benjamin Walter)
## Level(2)
## Language(en)
###############################################



DOCUMENT();

loadMacros(
"PGstandard.pl",
"PGcourse.pl",
"MathObjects.pl",
"niceTables.pl",
"contextFraction.pl"
);

TEXT(beginproblem());

Context("Numeric");
Context()->variables->are(x=>'Real',C=>'Real',c=>'Real');


###########
#
# Dchecker checks answers by computing derivative
#
#  cmp( checker=>$Dchecker, deriv=>$f )
#
$Dchecker = sub {  
  my ($c, $s, $ansHash) = @_;
  my $deriv = $ansHash->{deriv};
  $ansHash->{prev_ans}='';

  $s = Formula($s);

  return ($deriv == $s->D('x'));
};


Context("Fraction");
Context()->variables->are(x=>'Real',C=>'Real',c=>'Real');


my @c; my @p; my $u; 


# f1 = (linear)^n 
# f2 = sqrt[q](linear) 
# f3 = 1/(linear)^n

#
 do { foreach my $i (0..1) { $c[$i] = random(-1,1,2)*random(2,8); } } 
 until (($c[0]!=$c[1]) && (!(($c[0]<0) && ($c[1]<0))));
 $u  = Formula("($c[0]*x+$c[1])")->reduce;
#
$p[0] = random(2,8);
$f1 = Formula("($u)^($p[0])")->reduce;
$df1 = Formula("$p[0]*$c[0]*($u)^($p[0]-1)")->reduce;
$int1= Formula("1/($c[0]*($p[0]+1)) * ($u)^($p[0]+1) ")->reduce;


#
 do { foreach my $i (0..1) { $c[$i] = random(-1,1,2)*random(2,8); } } 
 until (($c[0]!=$c[1]) && (!(($c[0]<0) && ($c[1]<0))));
 $u  = Formula("($c[0]*x+$c[1])")->reduce;
 $u->{limits} = ($c[0]>0) ? [(1-$c[1])/$c[0], 3+(1-$c[1])/$c[0]]
                          : [-3-(1+$c[1])/$c[0], -(1+$c[1])/$c[0]];
#
$p[0] = random(2,8);
$f2 = Formula("($u)^(1/$p[0])")->reduce;
$f2->{limits}  = $u->{limits};

my $pow = (1-$p[0])/($p[0]);
$df2  = Formula("($c[0]/$p[0])*($u)^($pow)");
$df2->{limits} = $u->{limits};

$int2 = Formula("($p[0]/($c[0]*($p[0]+1)))*($u)^(1+1/$p[0])")->reduce;
if ($p[0]==2) { $p[0]=""; }
$f2_t = $u->TeX;  $f2_t = "\sqrt[$p[0]]{$f2_t}";  

#
 do { foreach my $i (0..1) { $c[$i] = random(-1,1,2)*random(2,8); } } 
 until (($c[0]!=$c[1]) && (!(($c[0]<0) && ($c[1]<0))));
 $u  = Formula("($c[0]*x+$c[1])")->reduce;
 $u->{limits} = [(1-$c[1])/$c[0],(1-$c[1])/$c[0]+3];
#
$p[0] = random(2,8);
$f3 = Formula("1/($u)^($p[0])")->reduce;
$df3  = Formula("-$p[0]*$c[0]*1/($u)^($p[0]+1)")->reduce; 
$f3->{limits}  = $u->{limits};
$df3->{limits} = $u->{limits};
$int3 = Formula("1/($c[0]*(1-$p[0]))*1/($u)^($p[0]-1)")->reduce; 

Context()->texStrings;

BEGIN_TEXT

Compute the following derivatives and integrals.
$PAR

END_TEXT
#$BBOLD A.$EBOLD 
#\(\quad\displaystyle f(x) = $f1\) 
#$PAR 
#\(\displaystyle \qquad \frac{d}{dx}\Bigl[ $f1 \Bigr] =\ \) \{ ans_rule(15)\}
#$PAR 
#\(\displaystyle \qquad \int\; $f1\;dx  =\ \)\{ ans_rule(18) \}\(\ +\ C\)
#
#$PAR$BR$PAR
BEGIN_TEXT

$BBOLD (A)$EBOLD 
\(\displaystyle \ \ \ \frac{d}{dx}\Bigl[ $f2_t \Bigr] =\ \) \{ ans_rule(15)\}
$PAR
\(\displaystyle \qquad \int\; $f2_t\;dx  =\ \)\{ ans_rule(18) \}\(\ +\ C\)


$PAR$BR$PAR


$BBOLD (B)$EBOLD 
\(\displaystyle \ \ \ \frac{d}{dx}\Biggl[ $f3 \Biggr] =\ \)\{ ans_rule(15)\}
$PAR
\(\displaystyle \qquad \int\; $f3\;dx  =\ \)\{ ans_rule(18) \}\(\ +\ C\)

$PAR$HR$PAR

$BBOLD (C)$EBOLD Compute the following using 
$BBOLD logarithmic differentiation $EBOLD 
$PAR $SPACE $SPACE Give detailed steps on your solution paper.
$PAR
\(\displaystyle \qquad \frac{d}{dx}\biggl[ x^x \biggr] =\ \)\{ ans_rule(15)\}

END_TEXT
Context()->normalStrings;
Context()->variables->are(x=>'Real',C=>'Real',c=>'Real');

my $C = Formula("C");
my $int_cmp; 

#ANS( $df1->inContext(Context("Numeric"))->cmp() ); 
# $int_cmp = ($int1+$C)->cmp(checker=>$Dchecker,deriv=>$f1);
# pop(@{$int_cmp->{post_filters}});
# ANS( $int_cmp );

ANS( $df2->inContext(Context("Numeric"))->cmp() );
 $int_cmp = ($int2+$C)->cmp(checker=>$Dchecker,deriv=>$f2);
 pop(@{$int_cmp->{post_filters}});
 ANS( $int_cmp );

ANS( $df3->inContext(Context("Numeric"))->cmp() ); 
 $int_cmp = ($int3+$C)->cmp(checker=>$Dchecker,deriv=>$f3);
 pop(@{$int_cmp->{post_filters}});
 ANS( $int_cmp );

ANS(Formula("x^x ln|x| + x^x")->inContext(Context("Numeric"))->cmp() );

ENDDOCUMENT();        # This should be the last executable line in the problem.
